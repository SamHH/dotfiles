# Locking
exec swayidle -w before-sleep 'swaylock -f -c 000000'

# Notifications
exec mako

# Trackpad
input "1452:628:bcm5974" {
  dwt enabled
  natural_scroll enabled
}

# Keyboard
input "1452:628:Apple_Inc._Apple_Internal_Keyboard_/_Trackpad" {
  xkb_model apple_laptop
  xkb_layout gb(mac)
  xkb_options caps:swapescape
}

# General
focus_follows_mouse no

# Theming (Nord colors)
font pango:Monaco 11
default_border pixel 3
smart_borders off
gaps outer 0
gaps inner 16

## Colors
set $nord0  #2e3440
set $nord1  #3b4252
set $nord2  #434c5e
set $nord3  #4c556a
set $nord4  #d8dee9
set $nord5  #e5e9f0
set $nord6  #eceff4
set $nord11 #bf616a

### target                border    background   text     indicator   child_border
client.focused            $nord3    $nord2       $nord5   $nord3      $nord3
client.unfocused          $nord0    $nord0       $nord4   $nord3      $nord0
client.focused_inactive   $nord0    $nord1       $nord4   $nord3      $nord0
client.urgent             $nord11   $nord11      $nord6   $nord3      $nord3

# Custom launchers
set $launcher_window_title launcher
for_window [title="^launcher$"] floating enable, border pixel

# Mod key
set $mod Mod4

# Toggle trackpad
bindsym $mod+Shift+z input "1452:628:bcm5974" events toggle

# Start a terminal
bindsym $mod+Return exec alacritty

# Kill focused window
bindsym $mod+Shift+q kill

# Launcher
bindsym $mod+d exec ~/scripts/launcher.sh "dmenu_path | fzf | xargs --no-run-if-empty swaymsg exec" $launcher_window_title

# Bookmarks
bindsym $mod+Shift+d exec ~/scripts/launcher.sh "~/scripts/flatmarks.sh | xargs --no-run-if-empty swaymsg exec xdg-open" $launcher_window_title

# Passwords
bindsym $mod+Shift+x exec ~/scripts/launcher.sh "~/scripts/pass-fzf-password.sh" $launcher_window_title
bindsym $mod+Shift+n exec ~/scripts/launcher.sh "~/scripts/pass-fzf-prefixed-line.sh 'username: ' username" $launcher_window_title
bindsym $mod+Shift+m exec ~/scripts/launcher.sh "~/scripts/pass-fzf-prefixed-line.sh 'email: ' email" $launcher_window_title

# Clipboard
# exec_always greenclip daemon
# bindsym $mod+Shift+p exec rofi -lines 5 -modi "clipboard:greenclip print" -show clipboard

# Screenshot region and copy to clipboard
bindsym $mod+Shift+p exec grim -g \"$(slurp)" - | wl-copy

# Dismiss notifications
bindsym Ctrl+Space exec makoctl dismiss
bindsym Ctrl+Shift+Space exec makoctl dismiss --all

# Calculator & conversions
bindsym $mod+Shift+o exec ~/scripts/launcher.sh "qalc" $launcher_window_title

# Translations
bindsym $mod+Shift+t exec ~/scripts/launcher.sh "trans -brief -s it -t en" $launcher_window_title
bindsym $mod+Shift+y exec ~/scripts/launcher.sh "trans -brief -s en -t it" $launcher_window_title

# Wallpaper
bindsym $mod+Shift+w exec ~/scripts/wallpaper.sh

# Change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# Move focused container around
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# Split horizontally / vertically
bindsym $mod+c split h
bindsym $mod+v split v

# Toggle fullscreen for focused
bindsym $mod+f fullscreen toggle

# Change container layout (stacked, tabbed, toggle split)
bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split

# Toggle tiling / floating
bindsym $mod+Shift+Space floating toggle

# Change focus between tiling / floating windows
bindsym $mod+Space focus mode_toggle

# Toggle sticky
bindsym $mod+Shift+s sticky toggle

# Enable floating video mode
bindsym $mod+Shift+a floating enable; sticky enable; resize set 880 495; move window to position 1970 1270

# Switch to workspace
bindsym $mod+1 workspace 1 web
bindsym $mod+2 workspace 2 code1
bindsym $mod+3 workspace 3 code2
bindsym $mod+4 workspace 4 code3
bindsym $mod+5 workspace 5 code4
bindsym $mod+6 workspace 6
bindsym $mod+7 workspace 7
bindsym $mod+8 workspace 8 social
bindsym $mod+9 workspace 9 email
bindsym $mod+0 workspace 10 task

# Move focused container to workspace
bindsym $mod+Shift+1 move container to workspace 1 web
bindsym $mod+Shift+2 move container to workspace 2 code1
bindsym $mod+Shift+3 move container to workspace 3 code2
bindsym $mod+Shift+4 move container to workspace 4 code3
bindsym $mod+Shift+5 move container to workspace 5 code4
bindsym $mod+Shift+6 move container to workspace 6
bindsym $mod+Shift+7 move container to workspace 7
bindsym $mod+Shift+8 move container to workspace 8 social
bindsym $mod+Shift+9 move container to workspace 9 email
bindsym $mod+Shift+0 move container to workspace 10 task

# Assign GUI apps to specific workspaces by default
assign [class="Telegram"] 8 social
assign [class="Slack"] 8 social
assign [class="Protonmail Desktop"] 9 email
assign [class="Mozilla Thunderbird"] 9 email

# Reload config
bindsym $mod+Shift+c reload

# Exit Sway (requires mouse confirmation)
bindsym $mod+Shift+e exec "swaynag -t warning -m 'You pressed the exit shortcut. Do you really want to exit Sway? This will end your Wayland session.' -b 'Yes, exit Sway' 'swaymsg exit'"

# Resize mode
mode "resize" {
  bindsym h resize shrink width 10 px or 10 ppt
  bindsym j resize grow height 10 px or 10 ppt
  bindsym k resize shrink height 10 px or 10 ppt
  bindsym l resize grow width 10 px or 10 ppt

  # Leave resize mode w/ Enter or Esc
  bindsym Return mode "default"
  bindsym Escape mode "default"
}

bindsym $mod+r mode "resize"

# Volume control
bindsym XF86AudioRaiseVolume exec pulsemixer --unmute --change-volume 5
bindsym XF86AudioLowerVolume exec pulsemixer --unmute --change-volume -5
bindsym XF86AudioMute exec pulsemixer --toggle-mute

# Screen brightness control
bindsym XF86MonBrightnessUp exec light -T 1.4
bindsym XF86MonBrightnessDown exec light -T 0.6

# Keyboard backlight control
bindsym XF86KbdBrightnessUp exec light -A 20 -s sysfs/leds/smc::kbd_backlight
bindsym XF86KbdBrightnessDown exec light -U 20 -s sysfs/leds/smc::kbd_backlight

# Media control
bindsym XF86AudioPlay exec playerctl play-pause
bindsym XF86AudioNext exec playerctl next
bindsym XF86AudioPrev exec playerctl previous

bar {
  swaybar_command waybar
}

